import{ab as g,Z as N,r as c,c as h,s as i,G as n,R as r,p as o,ac as R,ad as S,ae as w,af as z,b as m,k as O,m as P,u as U,e as W,i as I,ah as v,ai as k,aj as E,ag as y,ak as H,x as B,d as A}from"./index-243f2949.js";const F={class:"box"},j={__name:"index",setup(M){const p=g({results:[]});N(()=>{p.results=n.tabs[n.currentTab].database.results.map(t=>{const e=i.settings.staff.departments.find(l=>l.value===t.department),a=i.settings.staff.departments.find(l=>l.value===t.department).ranks.find(l=>l.value===t.rank),s=c({identifier:t.identifier,fullname:t.fullname,alias:t.alias,department:e==null?void 0:e.label,rank:a==null?void 0:a.label});return n.tabs[n.currentTab].database.tables.forEach(l=>{s.value[l.label]=t.data[l.column]}),s.value})});const x=t=>{switch(t){case"checkbox":return 200;case"input-number":case"select":return 200;case"input":case"input-textarea":return 200;default:return 200}},u=c(0),C=h(()=>{u.value=0,u.value+=150*5;const t=c([{title:i.locale.PLACEHOLDER.STATEID,key:"identifier",width:150,minWidth:50,ellipsis:{tooltip:!0},resizable:!0,fixed:"left",sorter:(e,a)=>e.identifier-a.identifier},{title:i.locale.PLACEHOLDER.FULLNAME,key:"fullname",width:150,minWidth:50,ellipsis:{tooltip:!0},resizable:!0,sorter:(e,a)=>e.name.localeCompare(a.name)},{title:i.locale.PLACEHOLDER.ALIAS,key:"alias",width:150,minWidth:50,ellipsis:{tooltip:!0},resizable:!0,sorter:(e,a)=>e.alias.localeCompare(a.alias)},{title:i.locale.PLACEHOLDER.DEPARTMENT,key:"department",width:150,minWidth:50,ellipsis:{tooltip:!0},resizable:!0,sorter:(e,a)=>e.alias.localeCompare(a.alias)},{title:i.locale.PLACEHOLDER.RANK,key:"rank",width:150,minWidth:50,ellipsis:{tooltip:!0},resizable:!0,sorter:(e,a)=>e.alias.localeCompare(a.alias)}]);return n.tabs[n.currentTab].database.tables.forEach(e=>{const a=x(e.type);u.value+=a,t.value.push({title:e.label,key:e.label,width:a,minWidth:50,resizable:!0,ellipsis:{tooltip:!0},render(s){switch(e.type){case"checkbox":return r(z,{checked:s[e.label],"onUpdate:checked":l=>{s[e.label]=l},disabled:!o(1142)});case"input-number":return r(w,{value:s[e.label],"onUpdate:value":l=>{s[e.label]=l},disabled:!o(1142)});case"input":case"input-textarea":return r(S,{value:s[e.label],"onUpdate:value":l=>{s[e.label]=l},disabled:!o(1142)});case"select":return r(R,{value:s[e.label],options:e.options,"onUpdate:value":l=>{s[e.label]=l},disabled:!o(1142)});default:return r("div",{},"Invalid type")}}})}),!o(1142)&&!o(1143)||(u.value+=93,t.value.push({title:i.locale.PLACEHOLDER.ACTIONS,key:"actions",width:93,fixed:"right",render:e=>{const a=[];return o(1142)&&a.push(r(y,{},{trigger:()=>r(v,{type:"primary",tertiary:!0,size:"small",onClick:()=>{const s={};n.tabs[n.currentTab].database.tables.forEach(l=>{s[l.column]=e[l.label]}),k("update","database",e.identifier,s)}},{default:()=>r(E,{icon:["fas","floppy-disk"]})}),default:()=>i.locale.UPDATE})),o(1143)&&a.push(r(y,{},{trigger:()=>r(v,{type:"primary",tertiary:!0,size:"small",onClick:()=>k("remove","database",e.identifier)},{default:()=>r(E,{icon:["fas","trash"]})}),default:()=>i.locale.REMOVE})),r(H,{align:"center",size:"small"},()=>a)}})),t.value}),d=c(!1),b=c(0),f=c(0),T=t=>{t==="add"&&(n.tabs[n.currentTab].shared.addUser.type="database",n.tabs[n.currentTab].shared.addUser.view=!0),d.value=!1},_=t=>{t.preventDefault(),d.value=!1,B().then(()=>{d.value=!0,b.value=t.clientX,f.value=t.clientY})},D=()=>{d.value=!1},L=h(()=>[{key:"add",label:i.locale.STAFF.DATABASE.ADD}]);return(t,e)=>{const a=m("n-data-table"),s=m("n-dropdown");return A(),O("div",F,[P(a,{onContextmenu:_,class:"staff-tables",columns:C.value,data:p.results,pagination:{pageSize:20},"scroll-x":u.value+200},null,8,["columns","data","scroll-x"]),U(o)(1141)?(A(),W(s,{key:0,placement:"bottom-start",trigger:"manual",x:b.value,y:f.value,options:L.value,show:d.value,"on-clickoutside":D,onSelect:T},null,8,["x","y","options","show"])):I("",!0)])}}};export{j as default};
