import{b as i,d as v,e as b,w as n,m as t,D as _e,u as s,G as a,l as be,p as pe,H as he,c as L,r as H,o as ge,E as we,S as Te,a as Se,f as B,t as x,g as Ee,s as p,h as j,i as $,I as xe,k as O,F as M,n as F,y as Ce,N as X,B as ye,T as le,M as ke,O as z,P as ae,Q as se}from"./index-243f2949.js";import{_ as De}from"./TopActions-1d666594.js";import{_ as Ie}from"./EditorContent-c7da8fcb.js";import{_ as Le}from"./Box-066ea52c.js";import"./RelatedCard-1683bb11.js";const Ae={__name:"Input",setup(e){return(o,c)=>{const r=i("font-awesome-icon"),l=i("n-icon"),u=i("n-input");return v(),b(u,{onKeyup:c[0]||(c[0]=_e(d=>s(he)(s(a).tabs[s(a).currentTab].incidents.search),["enter"])),value:s(a).tabs[s(a).currentTab].incidents.search,"onUpdate:value":c[1]||(c[1]=d=>s(a).tabs[s(a).currentTab].incidents.search=d),placeholder:s(be).PLACEHOLDER.SEARCH,clearable:"",disabled:!s(pe)(301)},{prefix:n(()=>[t(l,null,{default:n(()=>[t(r,{icon:["fas","magnifying-glass"]})]),_:1})]),_:1},8,["value","placeholder","disabled"])}}},Ne=["innerHTML"],Re={__name:"Card",props:{id:Number,title:String,date:Number,content:String,author:String},setup(e){const o=e,c=L(()=>r.value?r.value.getHTML():""),r=H(null);return ge(()=>{r.value=new we({editable:!1,content:o.content,extensions:[Te]})}),Se(()=>{r.value.destroy()}),(l,u)=>{const d=i("n-ellipsis"),m=i("n-card");return v(),b(m,{onClick:u[0]||(u[0]=y=>s(xe)(e.id)),title:"#"+e.id+" "+e.title,hoverable:"",size:"small"},{"header-extra":n(()=>{var y;return[B(x((y=s(Ee)(e.date))==null?void 0:y.time),1)]}),footer:n(()=>[B(x(s(p).locale.CREATED_BY.replace("{user}",e.author)),1)]),default:n(()=>[c.value?(v(),b(d,{key:0,"line-clamp":3,tooltip:!1},{default:n(()=>[j("div",{innerHTML:c.value},null,8,Ne)]),_:1})):$("",!0)]),_:1},8,["title"])}}},je={__name:"BoxLeft",setup(e){return(o,c)=>{const r=i("n-divider"),l=i("n-space"),u=i("n-scrollbar");return v(),O(M,null,[j("h3",null,x(s(p).locale.INCIDENTS.LABEL),1),t(Ae),t(r),t(u,{class:"scrollbar-results"},{default:n(()=>[t(l,{vertical:"",size:[10,10]},{default:n(()=>[(v(!0),O(M,null,F(s(a).tabs[s(a).currentTab].incidents.results,d=>(v(),b(Re,{id:d.id,title:d.title,date:d.date,content:d.content,author:d.author},null,8,["id","title","date","content","author"]))),256))]),_:1})]),_:1})],64)}}},ze={__name:"Top",setup(e){return(o,c)=>(v(),b(De,{target:"incidents",buttons:["create","unlink","save","delete","clear"],required:["title","content"],permissions:{create:302,edit:303,delete:304}}))}},$e={__name:"Middle",setup(e){const o=p.locale.PLACEHOLDER,c=L(()=>{const r=a.tabs[a.currentTab].incidents;return r.stats.id?r.stats:r.new});return(r,l)=>{const u=i("n-input"),d=i("n-space");return v(),b(d,{vertical:""},{default:n(()=>[t(u,{placeholder:s(o).TITLE,value:c.value.title,"onUpdate:value":l[0]||(l[0]=m=>c.value.title=m)},null,8,["placeholder","value"]),t(Ie,{modelValue:c.value.content,"onUpdate:modelValue":l[1]||(l[1]=m=>c.value.content=m),disabled:!1,class:Ce("incident-notes"),placeholder:s(o).NOTES},null,8,["modelValue","placeholder"]),s(p).settings.incidents.show_location?(v(),b(u,{key:0,placeholder:s(o).LOCATION,value:c.value.location,"onUpdate:value":l[2]||(l[2]=m=>c.value.location=m)},null,8,["placeholder","value"])):$("",!0)]),_:1})}}},Be={__name:"Bottom",setup(e){const o=["officers","citizens","incidents","reports","evidence","vehicles","tags","gallery"],c=l=>{const u=p.settings.incidents[`show_${l}`],d=u&&a.tabs[a.currentTab].incidents.stats.id?a.tabs[a.currentTab].incidents.stats[l]:a.tabs[a.currentTab].incidents.new[l],m=()=>{["officers","citizens"].includes(l)?(a.tabs[a.currentTab].shared.addUser.type=l,a.tabs[a.currentTab].shared.addUser.view=!0):["incidents","reports","evidence"].includes(l)?(a.tabs[a.currentTab].shared.addRelated.type=l,a.tabs[a.currentTab].shared.addRelated.view=!0):l==="vehicles"?a.tabs[a.currentTab].shared.searchPlate.view=!0:l==="tags"?(a.tabs[a.currentTab].shared.viewAddTagType="incidents",a.tabs[a.currentTab].shared.viewAddTag=!0):l==="gallery"&&(a.tabs[a.currentTab].shared.addToGallery.type="incidents",a.tabs[a.currentTab].shared.addToGalleryView=!0)};return{identifier:l,title:p.locale.BOXES[l.toUpperCase()],visible:u,array:d,onClick:m}},r=L(()=>o.map(l=>c(l)).filter(l=>l.visible));return(l,u)=>{const d=i("n-gi"),m=i("n-grid"),y=i("n-scrollbar");return v(),b(y,null,{default:n(()=>[t(m,{"y-gap":"10",cols:1},{default:n(()=>[(v(!0),O(M,null,F(r.value,(k,E)=>(v(),b(d,{key:E},{default:n(()=>[t(Le,{name:"incidents",identifier:k.identifier,title:k.title,visible:k.visible,array:k.array,onClick:k.onClick},null,8,["identifier","title","visible","array","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})}}},Oe={__name:"BoxMiddle",setup(e){const o=p.locale.INCIDENTS;return(c,r)=>{const l=i("n-space"),u=i("n-divider"),d=i("n-gi"),m=i("n-grid");return v(),b(m,{cols:"1","y-gap":"10px"},{default:n(()=>[t(d,{class:"sub-sub-box"},{default:n(()=>[t(l,{justify:"space-between"},{default:n(()=>[j("h3",null,x(s(a).tabs[s(a).currentTab].incidents.stats.id?s(o).EDIT.replace("{id}","#"+s(a).tabs[s(a).currentTab].incidents.stats.id):s(o).EDIT.replace("{id}","")),1),t(ze)]),_:1}),t(u),t($e)]),_:1}),t(d,{class:"sub-sub-box"},{default:n(()=>[t(Be)]),_:1})]),_:1})}}},Ue={__name:"Top",setup(e){function o(){a.tabs[a.currentTab].shared.addUser.type="criminals",a.tabs[a.currentTab].shared.addUser.view=!0}return(c,r)=>{const l=i("font-awesome-icon"),u=i("n-icon"),d=i("n-button"),m=i("n-space");return v(),b(m,{justify:"space-between"},{default:n(()=>[j("h4",null,x(s(p).locale.INCIDENTS.CRIMINAL.LABEL),1),t(d,{onClick:r[0]||(r[0]=y=>o()),tertiary:"",circle:"",size:"tiny"},{icon:n(()=>[t(u,null,{default:n(()=>[t(l,{icon:["fas","plus"]})]),_:1})]),_:1})]),_:1})}}},Pe={__name:"HeaderExtra",props:{identifier:String,customSentence:Boolean,sentenceExecuted:Boolean},setup(e){const o=e,c=L(()=>{const u=a.tabs[a.currentTab].incidents;return u.stats.id?u.stats.criminals:u.new.criminals});function r(){const u=c.value.findIndex(d=>d.identifier===o.identifier);u!==-1&&c.value.splice(u,1)}function l(){a.tabs[a.currentTab].incidents.criminalSelected=o.identifier,a.tabs[a.currentTab].charges.add=!0}return(u,d)=>{const m=i("font-awesome-icon"),y=i("n-icon"),k=i("n-button"),E=i("n-tooltip"),D=i("n-space");return v(),b(D,{size:"small"},{default:n(()=>[t(E,{trigger:"hover","show-arrow":!1},{trigger:n(()=>[t(k,{onClick:d[0]||(d[0]=A=>l()),size:"small",circle:"",tertiary:"",disabled:(e.customSentence||e.sentenceExecuted)??!1},{icon:n(()=>[t(y,{size:"small"},{default:n(()=>[t(m,{icon:["fas","file-invoice"]})]),_:1})]),_:1},8,["disabled"])]),default:n(()=>[B(" "+x(s(p).locale.INCIDENTS.CRIMINAL.CRIMINALS.EDIT),1)]),_:1}),t(E,{trigger:"hover","show-arrow":!1},{trigger:n(()=>[t(k,{onClick:d[1]||(d[1]=A=>r()),size:"small",circle:"",tertiary:"",disabled:(e.customSentence||e.sentenceExecuted)??!1},{icon:n(()=>[t(y,{size:"small"},{default:n(()=>[t(m,{icon:["fas","trash"]})]),_:1})]),_:1},8,["disabled"])]),default:n(()=>[B(" "+x(s(p).locale.DELETE),1)]),_:1})]),_:1})}}},He={__name:"Reduction",props:{identifier:String,fine:Number,jail:Number,points:Number,sentenceExecuted:Boolean,disabled:Boolean},setup(e){const o=e,c=p.locale.INCIDENTS.CRIMINAL.CRIMINALS.REDUCTION,r=L(()=>a.tabs[a.currentTab]),l=H(!1),u=H(p.settings.incidents.reductions),d=L(()=>{var A;const D=(r.value.incidents.stats.id?r.value.incidents.stats:r.value.incidents.new).criminals.find(R=>R.identifier===o.identifier);if(D){const R=(A=D.charges)==null?void 0:A.map(h=>{var V,W;const T=(W=(V=a.tabs[a.currentTab].charges)==null?void 0:V.results)==null?void 0:W.find(G=>G.id===h.id);if(T)return{fine:T.fine*h.amount,jail:T.jail*h.amount,points:T.points*h.amount}}),I={fine:R.reduce((h,T)=>h+T.fine,0),jail:R.reduce((h,T)=>h+T.jail,0),points:R.reduce((h,T)=>h+T.points,0)},U=u.value.map(h=>{const T={fine:p.settings.incidents.fine_reduction?I.fine-h/100*I.fine:I.fine,jail:p.settings.incidents.jail_reduction?I.jail-h/100*I.jail:I.jail,points:p.settings.incidents.points_reduction?I.points-h/100*I.points:I.points};return{value:h,label:c.DATA.replace("{percentage}",h).replace("{fine}",T.fine).replace("{jail}",T.jail).replace("{points}",T.points)}});return D.chosenReduction&&U.find(T=>{T.value,D.chosenReduction})&&(l.value=!0),U??[]}}),m=()=>(r.value.incidents.stats.id?r.value.incidents.stats:r.value.incidents.new).criminals.find(A=>A.identifier===o.identifier);function y(E){const D=m();D&&(D.chosenReduction=E)}const k=()=>{const E=m();E.sentenceExecuted=!0,X("criminalSentence",{identifier:o.identifier,fine:o.fine,jail:o.jail,points:o.points})};return(E,D)=>{const A=i("n-select"),R=i("font-awesome-icon"),I=i("n-button"),U=i("n-input-group");return v(),O(M,null,[B(x(s(c).LABEL)+" ",1),t(U,null,{default:n(()=>[t(A,{options:d.value,"onUpdate:value":y,"default-value":d.value[0].value,placeholder:s(c).PLACEHOLDER,disabled:e.disabled??!1},null,8,["options","default-value","placeholder","disabled"]),t(I,{tertiary:"",disabled:e.disabled,onClick:k},{default:n(()=>[t(R,{icon:["fas","location-arrow"]})]),_:1},8,["disabled"])]),_:1})],64)}}},Me={key:0},Ve={__name:"Card",props:{values:Object},setup(e){const o=e,c=p.locale.INCIDENTS.CRIMINAL.CRIMINALS,r=L(()=>a.tabs[a.currentTab]),l=L(()=>r.value.incidents.stats.id?r.value.incidents.stats:r.value.incidents.new),u=()=>c.LABEL.replace("{identifier}",y(o.values.identifier)).replace("{fullname}",o.values.fullname),d=L(()=>l.value.criminals.find(f=>f.identifier===o.values.identifier)),m=L(()=>{var f;return((f=d.value)==null?void 0:f.charges)||[]}),y=f=>f.length>10?f.substring(0,10)+"...":f,k=(f,_)=>{var S,g;return(g=(S=a.tabs[a.currentTab][_])==null?void 0:S.results)==null?void 0:g.find(C=>C.id===f)},E=f=>k(f,"charges"),D=f=>k(f,"categories"),A=(f,_)=>{const S=d.value;S&&(S[f]=_,(f==="warrant"||f==="hold")&&(S.trial=!1,f==="warrant"&&(S.hold=!1)))},R=f=>[L(()=>{var g;return!!((g=d.value)!=null&&g[f])}),g=>A(f,g)],[[I,U],[h,T],[V,W],[G,ie],[ce,oe]]=["warrant","hold","trial","pleaded","processed"].map(R);ye([m,()=>{var f;return(f=d.value)==null?void 0:f.chosenReduction}],([f,_])=>{if(f&&_!=null){const S=f.reduce((C,N)=>{const P=E(N.id);return P&&(C.fine+=P.fine*N.amount,C.jail+=P.jail*N.amount,C.points+=P.points*N.amount),C},{fine:0,jail:0,points:0});Object.keys(S).forEach(C=>S[C]-=_/100*S[C]);const g=d.value;g&&Object.assign(g,S)}},{deep:!0});const K=H(null),q=H(null),J=H(null);function re(){o.values.warrant&&o.values.hold&&o.values.trial&&(o.values.customSentence=!0,X("criminalCustomSentence",{identifier:o.values.identifier,fine:K.value,jail:q.value,points:J.value}))}function de(f){const _=m==null?void 0:m.value,S=_.findIndex(g=>g.id===f);_.splice(S,1)}const ue=()=>{o.values.warrantData.created=!0,X("criminalCreateWarrant",{identifier:o.values.identifier,reason:o.values.warrantData.reason,date:o.values.warrantData.date})};return(f,_)=>{const S=i("n-tag"),g=i("n-space"),C=i("n-divider"),N=i("n-checkbox"),P=i("n-input"),fe=i("n-date-picker"),Y=i("n-button"),Z=i("n-input-group"),Q=i("n-input-number"),me=i("font-awesome-icon"),ve=i("n-card");return v(),b(ve,{size:"small",bordered:!1,title:u()},{"header-extra":n(()=>[t(Pe,{identifier:e.values.identifier,customSentence:e.values.customSentence??!1,sentenceExecuted:e.values.sentenceExecuted??!1},null,8,["identifier","customSentence","sentenceExecuted"])]),default:n(()=>[t(g,{vertical:"",size:"small"},{default:n(()=>{var ee,te;return[t(g,{size:[8,8]},{default:n(()=>[t(le,{name:"slide-fade",tag:"div",class:"transition-flex"},{default:n(()=>[(v(!0),O(M,null,F(m.value,w=>{var ne;return v(),b(S,{key:w.id,bordered:!1,size:"small",closable:"",onClose:Ge=>de(w.id),style:ke({backgroundColor:(ne=D(E(w.id).category))==null?void 0:ne.color}),disabled:(e.values.customSentence||e.values.sentenceExecuted)??!1},{default:n(()=>[B(x(E(w.id).label+" x"+w.amount),1)]),_:2},1032,["onClose","style","disabled"])}),128))]),_:1})]),_:1}),t(C),t(g,{size:"small"},{default:n(()=>[t(z,{name:"slide-fade"},{default:n(()=>[t(N,{checked:s(I),"on-update:checked":s(U),size:"small",disabled:(e.values.warrantData.created||e.values.customSentence)??!1},{default:n(()=>[j("p",null,x(s(c).WARRANT),1)]),_:1},8,["checked","on-update:checked","disabled"])]),_:1}),t(z,{name:"slide-fade"},{default:n(()=>[ae(t(N,{checked:s(h),"on-update:checked":s(T),size:"small",disabled:e.values.customSentence??!1},{default:n(()=>[j("p",null,x(s(c).HOLD),1)]),_:1},8,["checked","on-update:checked","disabled"]),[[se,e.values.warrant]])]),_:1}),t(z,{name:"slide-fade"},{default:n(()=>[ae(t(N,{checked:s(V),"on-update:checked":s(W),size:"small",disabled:e.values.customSentence??!1},{default:n(()=>[j("p",null,x(s(c).TRIAL),1)]),_:1},8,["checked","on-update:checked","disabled"]),[[se,e.values.warrant&&e.values.hold]])]),_:1})]),_:1}),t(z,{name:"slide-fade"},{default:n(()=>[e.values.warrant?(v(),b(g,{key:0,vertical:"",size:"small"},{default:n(()=>[t(P,{placeholder:s(c).REASON,type:"textarea",size:"small",autosize:{minRows:3,maxRows:5},disabled:(e.values.customSentence||e.values.warrantData.created)??!1,value:e.values.warrantData.reason,"onUpdate:value":_[0]||(_[0]=w=>e.values.warrantData.reason=w)},null,8,["placeholder","disabled","value"]),t(Z,null,{default:n(()=>[t(fe,{placeholder:s(c).DATE,type:"datetime",format:s(p).settings.dateFormat,disabled:(e.values.customSentence||e.values.warrantData.created)??!1,value:e.values.warrantData.date,"onUpdate:value":_[1]||(_[1]=w=>e.values.warrantData.date=w),style:{width:"50%"}},null,8,["placeholder","format","disabled","value"]),t(Y,{tertiary:"",disabled:(!e.values.warrantData.reason||!e.values.warrantData.date||e.values.customSentence||e.values.warrantData.created)??!1,onClick:ue,style:{width:"50%"}},{default:n(()=>[B(x(s(p).locale.CREATE),1)]),_:1},8,["disabled"])]),_:1})]),_:1})):$("",!0)]),_:1}),t(C),((ee=m.value)==null?void 0:ee.length)>=1?(v(),b(He,{key:e.values.identifier,identifier:e.values.identifier,fine:e.values.fine,jail:e.values.jail,points:e.values.points,sentenceExecuted:e.values.sentenceExecuted,disabled:e.values.hold||e.values.customSentence||e.values.sentenceExecuted},null,8,["identifier","fine","jail","points","sentenceExecuted","disabled"])):$("",!0),t(z,{name:"slide-fade"},{default:n(()=>{var w;return[e.values.warrant&&e.values.hold&&e.values.trial&&((w=m.value)==null?void 0:w.length)>=1?(v(),b(C,{key:0})):$("",!0)]}),_:1}),t(z,{name:"slide-fade"},{default:n(()=>[e.values.warrant&&e.values.hold&&e.values.trial?(v(),O("div",Me,[e.values.warrant&&e.values.hold&&e.values.trial?(v(),b(g,{key:0,size:"small"},{default:n(()=>[t(Z,null,{default:n(()=>[t(Q,{placeholder:s(p).locale.PLACEHOLDER.FINE,min:0,value:K.value,"onUpdate:value":_[2]||(_[2]=w=>K.value=w),disabled:e.values.customSentence??!1},null,8,["placeholder","value","disabled"]),t(Q,{placeholder:s(p).locale.PLACEHOLDER.JAIL,min:0,value:q.value,"onUpdate:value":_[3]||(_[3]=w=>q.value=w),disabled:e.values.customSentence??!1},null,8,["placeholder","value","disabled"]),t(Q,{placeholder:s(p).locale.PLACEHOLDER.POINTS,min:0,value:J.value,"onUpdate:value":_[4]||(_[4]=w=>J.value=w),disabled:e.values.customSentence??!1},null,8,["placeholder","value","disabled"]),t(Y,{tertiary:"",onClick:_[5]||(_[5]=w=>re()),disabled:e.values.customSentence??!1},{default:n(()=>[t(me,{icon:["fas","location-arrow"]})]),_:1},8,["disabled"])]),_:1})]),_:1})):$("",!0)])):$("",!0)]),_:1}),e.values.trial||((te=m.value)==null?void 0:te.length)>=1?(v(),b(C,{key:1})):$("",!0),t(g,{size:"small"},{default:n(()=>[t(z,{name:"slide-fade"},{default:n(()=>[t(N,{checked:s(G),"on-update:checked":s(ie),size:"small",disabled:e.values.customSentence??!1},{default:n(()=>[j("p",null,x(s(c).PLEADED),1)]),_:1},8,["checked","on-update:checked","disabled"])]),_:1}),t(z,{name:"slide-fade"},{default:n(()=>[t(N,{checked:s(ce),"on-update:checked":s(oe),size:"small",disabled:e.values.customSentence??!1},{default:n(()=>[j("p",null,x(s(c).PROCESSED),1)]),_:1},8,["checked","on-update:checked","disabled"])]),_:1})]),_:1})]}),_:1})]),_:1},8,["title"])}}},We={__name:"List",setup(e){const o=L(()=>{const c=a.tabs[a.currentTab].incidents;return c.stats.id?c.stats.criminals:c.new.criminals});return(c,r)=>(v(),b(le,{name:"slide-fade",tag:"div",style:{display:"flex","flex-wrap":"wrap",gap:"10px"}},{default:n(()=>[(v(!0),O(M,null,F(o.value,l=>(v(),b(Ve,{key:l.identifier,values:l},null,8,["values"]))),128))]),_:1}))}},Fe={__name:"BoxRight",setup(e){return(o,c)=>{const r=i("n-gi"),l=i("n-scrollbar"),u=i("n-space");return v(),b(u,{vertical:""},{default:n(()=>[t(r,{class:"sub-box"},{default:n(()=>[t(Ue)]),_:1}),t(l,{class:"scrollbar-criminals"},{default:n(()=>[t(We)]),_:1})]),_:1})}}},Ye={__name:"index",setup(e){return(o,c)=>{const r=i("n-gi"),l=i("n-grid");return v(),b(l,{"x-gap":"10",cols:"3"},{default:n(()=>[t(r,{class:"box"},{default:n(()=>[t(je)]),_:1}),t(r,null,{default:n(()=>[t(Oe)]),_:1}),t(r,{class:"box"},{default:n(()=>[t(Fe)]),_:1})]),_:1})}}};export{Ye as default};
